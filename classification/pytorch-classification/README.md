# Pytorch Classification

## Downstream Classification Performance of our paper
We tested whether the dataset generated by k-SALSA can be used to train accurate classifiers of clinical labels, in our case the grading of diabetic retiopathy (DR) included in our datasets.

## How to use
**Run to train:**
APTOS
```
CUDA_VISIBLE_DEVICES=0 python main.py \
--k k5 \
--crop 4 \
--lambda1 1e2 \
--lambda2 1e-6 \
-config configs/aptos.yaml \
--images_path ./aptos_k5_crop4_1e2_1e-6/style_proj \
--labels_train ./data/aptos/aptos_3000.csv \
--df ./k5_aptos_nearest_df.csv \
--test_images_path ./data/aptos/val \
--labels_test ./data/aptos/val_splited.csv \
--is_centroid False
```

EyePACS
```
CUDA_VISIBLE_DEVICES=0 python main_ours_2cls.py \
--k k5 \
--crop 4 \
--lambda1 1e2 \
--lambda2 1e-6 \
-config configs/eyepacs_2cls.yaml \
--images_path ./eyepacs_k5_crop4_1e2_1e-6/style_proj \
--labels_train ./data/eyepacs/eyepacs_10000.csv \
--df ./k5_aptos_nearest_df.csv \
--test_images_path ./data/aptos/val \
--labels_test ./data/eyepacs/val_splited.csv \
--is_centroid False
```
## Aknowledgements
- This code is based on [pytorch-classification](https://github.com/YijinHuang/pytorch-classification)